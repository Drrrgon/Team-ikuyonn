<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">



<mapper namespace="com.ikuyonn.project.socket.mapper.Mapper">
	<select id="getProjectContent" parameterType="string" resultType="table">
		select userid, message, to_char(messageDate, 'YY-MM-DD HH24:MI:SS') messageDate
		from message
		where projectName = #{projectName}
	 	AND
				 to_char(messageDate, 'DD') = to_char(messageDate, 'DD')
		order by messageSeq desc
		
	</select>
	
	<insert id="insertContent" parameterType="table" >
		INSERT INTO message
			VALUES( message_seq.nextVal
					, #{userID}
					, #{message}
					, sysdate
					, #{projectName})
	</insert>
	<select id="searchByDate" parameterType="map" resultType="table">
		SELECT userid, message, to_char(messageDate, 'YY-MM-DD HH24:MI:SS') messageDate
		FROM message
		WHERE projectName = #{projectName}
	 	AND
				 to_char(messageDate, 'YYYY-MM-DD') = #{date}
		order by messageSeq desc 	
	</select>
<!--  for maria db -->
	<!-- <select id="getRoomContent" parameterType="string" resultType="table">
		select id, message, date_format(date, "%Y-%m-%d %H:%i:%S") date
		from message
		where roomNum = #{roomNum} AND
				date_format(date, "%d") = date_format(now(), "%d")
		order by seq desc
		limit 125
	</select>
	
	<insert id="insertContent" parameterType="table" >
		INSERT INTO message
			VALUES( null
					, #{message}
					, #{id}
					, #{roomnum}
					, now())
	</insert> -->
</mapper>
